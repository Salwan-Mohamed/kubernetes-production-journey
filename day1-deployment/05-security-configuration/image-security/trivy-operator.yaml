# Trivy Operator Helm Values
# Automated container image scanning and SBOM generation

trivy:
  # Image scanning configuration
  image:
    registry: ghcr.io
    repository: aquasecurity/trivy
    tag: 0.48.0
  
  # Scan job configuration
  scanJob:
    enabled: true
    # Scan images on schedule
    schedule: "0 */6 * * *"  # Every 6 hours
    
  # Vulnerability database
  dbRepository: "ghcr.io/aquasecurity/trivy-db"
  
  # Severity levels to report
  severity: CRITICAL,HIGH,MEDIUM
  
  # Generate SBOM
  sbom:
    enabled: true
    format: cyclonedx

operator:
  # Operator configuration
  replicas: 1
  
  # Resource limits
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  # Vulnerability scanning settings
  vulnerabilityReportsPlugin: Trivy
  scanJobTimeout: 5m
  
  # Scan private registries
  privateRegistries:
    - registry: myregistry.io
      credentialsSecret: registry-credentials

# Service Monitor for Prometheus
serviceMonitor:
  enabled: true
  interval: 60s

# Reports configuration
vulnerabilityReports:
  # Generate reports for running workloads
  scanner: Trivy
  
# Expose metrics
metrics:
  enabled: true
  serviceMonitor:
    enabled: true
